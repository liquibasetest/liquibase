SELECT
  query_id,
  start_time,
  end_time,
  TIMESTAMP_DIFF(end_time, start_time, SECOND) AS execution_time_seconds,
  query_text
FROM
  TABLE(QUERY_HISTORY())
WHERE
  start_time > DATEADD(HOUR, -1, CURRENT_TIMESTAMP()) -- Adjust the time window as needed
ORDER BY
  start_time DESC;
