spark.sql("""
    UPDATE my_table
    SET eff_dt = concat(substring(partition_dt, 1, 4), '-', substring(partition_dt, 5, 2), '-', substring(partition_dt, 7, 2))
    WHERE metadata = 'your_condition'
""")
