import pyarrow.parquet as pq
import s3fs

# Define the S3 filesystem and root directory
s3 = s3fs.S3FileSystem()
root_dir = 's3://your-bucket-name/path/to/your/parquet/'

# Define the partition keys
partition_keys = ['partition_dt', 'contxt_id']

# Create ParquetDataset
dataset = pq.ParquetDataset(root_dir, filesystem=s3, partitioning=partition_keys)

# Get the schema of the dataset
schema = dataset.schema

# Now you can work with the schema
print(schema)
