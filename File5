import pyarrow.parquet as pq

# Define the S3 filesystem and root directory
s3 = fs = s3fs.S3FileSystem()
root_dir = 's3://your-bucket-name/path/to/your/parquet/'

# Define partition keys
partition_keys = ['partition_date', 'contxt_key_id']

# Create ParquetDataset
dataset = pq.ParquetDataset(root_dir, filesystem=s3, partitioning=partition_keys)

# Read the dataset as a PyArrow Table
table = dataset.read()

# Now you can work with the PyArrow Table 'table'
print(table)
