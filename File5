       filtered_table = table.filter((table['partition_dt'] == partition_dt) & (table['contxt_id'] == contxt_id))
        num_rows = filtered_table.num_rows
        num_files = min(max(num_rows // rows_per_file, min_files_per_partition), max_files_per_partition)
        rows_per_file = num_rows // num_files
        chunks = [filtered_table[i:i+rows_per_file] for i in range(0, num_rows, rows_per_file)]
        
